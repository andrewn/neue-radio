<!DOCTYPE html>
<html>
<head></head>
<body>
  <script type="module">
    import createWebsocket from '/websocket';
    const ws = createWebsocket({ debug: true });
    console.log('%cHello - really!', 'color:blue;font-weight:bold', 'messages from the server');
    ws.subscribe('radio/command/chord', function ({ topic, payload }) {
      console.log('chord', payload);
    });

    ws.subscribe(/.*/, function ({ topic, payload }) {
      console.log('subscribe');
      console.log(topic);
      console.log(payload);
    });

    const send = (topic, payload={}) => {
      ws.publish({ topic: `radio/command/${topic}`, payload });
    };

    document.getElementById('dove').addEventListener('click', () => (
      send('play', { params: { file: 'audio/Birdsong-Collared_Dove.mp3' } })
    ));

    document.getElementById('tit').addEventListener('click', () => (
      send('play', { params: { file: 'audio/Birdsong-Blue_Tit.mp3' } })
    ));

    document.getElementById('hls').addEventListener('click', () => (
      send('hls')
    ));

    document.getElementById('chord').addEventListener('click', () => (
      send('chord')
    ));
  </script>
  <h1>This is the public part of the radio app</h1>
  <p>Useful for remote controls etc</p>
  <button id="dove">Play birdsong - collared dove</button>
  <button id="tit">Play birdsong - blue tit</button>
  <button id="hls">Play HLS stream</button>
  <button id="chord">Generate Web Audio chord</button>
</body>
</html>
